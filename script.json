// ==========================================================
// *** GANTI DUA NILAI INI DENGAN ID DARI GOOGLE SHEETS ANDA ***
// ==========================================================
const SPREADSHEET_ID = 'Ganti_dengan_ID_SPREADSHEET_Anda';
const SHEET_ID = 'Ganti_dengan_ID_SHEET_Anda'; // Biasanya 0 untuk sheet pertama
// ==========================================================

const URL_SHEET = `https://docs.google.com/spreadsheets/d/${https://docs.google.com/spreadsheets/d/1KsTjy_SedUlpsCZXIRwy3x2sWRR-XXN4uvFgugVjDxo/edit?usp=sharing}/gviz/tq?tqx=out:json&gid=${1}`;
const tableElement = document.getElementById('attendance-table');

async function fetchData() {
    try {
        // Ambil data dari Google Sheets sebagai JSON
        const response = await fetch(URL_SHEET);
        const dataText = await response.text();
        
        // Membersihkan string JSON yang tidak standar dari Google Sheets
        const jsonString = dataText.substring(47).slice(0, -2);
        const jsonData = JSON.parse(jsonString);
        
        const rows = jsonData.table.rows;
        // Mengambil label header kolom
        const header = jsonData.table.cols.map(col => col.label);
        
        // 1. Membangun Header Tabel
        let htmlContent = '<thead><tr>';
        header.forEach(h => {
            htmlContent += `<th>${h}</th>`;
        });
        htmlContent += '</tr></thead><tbody>';
        
        // 2. Membangun Isi Baris Tabel
        rows.forEach(row => {
            htmlContent += '<tr>';
            row.c.forEach(cell => {
                // Mengambil nilai sel, jika kosong maka tampilkan string kosong
                const cellValue = cell && cell.v !== undefined ? cell.v : '';
                
                // Tambahkan kode untuk format tanggal atau angka jika diperlukan
                htmlContent += `<td>${cellValue}</td>`;
            });
            htmlContent += '</tr>';
        });
        htmlContent += '</tbody>';

        // Menampilkan tabel ke elemen HTML
        tableElement.innerHTML = htmlContent;
        tableElement.caption.textContent = 'Data Absensi Berhasil Dimuat';

    } catch (error) {
        console.error("Gagal mengambil data dari Google Sheets:", error);
        tableElement.innerHTML = `<caption>Error: Gagal memuat data. Periksa ID Spreadsheet/Sheet atau akses publik.</caption>`;
    }
}

// Panggil fungsi saat website selesai dimuat
document.addEventListener('DOMContentLoaded', fetchData);